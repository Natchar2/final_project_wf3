{% extends 'defaultLayout.html.twig' %}


{# titre de la page #}
{% block title %}
	Categorie {{ global.request.get('category_name') }} | Street Connexion
{% endblock %}

{# fil d'ariane #}
{% set active = global.request.get('category_name')|lower %}


	{% set pageMax = (totalProducts / nbPerPage)|round(0, 'ceil') %}

		{# 'total : ' ~ totalProducts ~ '***<br>' #}
		{# 'par page : ' ~ nbPerPage ~ '***<br>' #}
		{# 'pagesmax : ' ~ pageMax ~ '***<br>' #}
{# 'page : ' ~ pageMax ~ '***<br>' }}
{# 'products : ' ~ products|length ~ '***<br>' #}

{% block stylesheets %}
	{{parent()}}
	<link rel="stylesheet" href="{{asset('css/shop.css')}}">
{% endblock %}

{% block header %}
	{% include 'commerce/menu.html.twig' %}
{% endblock %}

{% block contenu %}
	<!-- include menu -->

	<!-- Page Content -->
	<div class="container">
		<div class="row">
			<div class="col-md-3">
				<h4 class="lead">Street Connect</h4>

				{{ render (controller('Application\\Controller\\InterfaceCommerceController::menuShop', { 'active':active } )) }}

			</div>

			<div class="col-md-9">
				<div class="row carousel-holder">
					<div class="col-md-12">
						<div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
							<ol class="carousel-indicators">
								<li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
								<li data-target="#carousel-example-generic" data-slide-to="1"></li>
								<li data-target="#carousel-example-generic" data-slide-to="2"></li>
							</ol>
							<div class="carousel-inner">
								<div class="item active">
									<img class="slide-image" src="http://placehold.it/800x100" alt="">
								</div>
								<div class="item">
									<img class="slide-image" src="http://placehold.it/800x100" alt="">
								</div>
								<div class="item">
									<img class="slide-image" src="http://placehold.it/800x100" alt="">
								</div>
							</div>
							<a class="left carousel-control" href="#carousel-example-generic" data-slide="prev">
								<span class="glyphicon glyphicon-chevron-left"></span>
							</a>
							<a class="right carousel-control" href="#carousel-example-generic" data-slide="next">
								<span class="glyphicon glyphicon-chevron-right"></span>
							</a>
						</div>
					</div>
				</div>


				<h3>
					{% if global.request.get('category_name') == "all" %}
						Tous les produits
					{% else %}
						{{ global.request.get('category_name') }}
					{% endif %}
				</h3>

				<div class="row">

					{% if products is empty %}
						<div class="alert alert-warning">Il n'y a pas encore d'products dans cette catégorie</div>
					{% else %}


						{% for product in products %}

							<div class="col-sm-4 col-lg-4 col-md-4 {{ global.request.get('category_name') }}">
								<div class="thumbnail">
									{% if product.image_1 > "" %}
										<img src="{{ asset('assets/images/'~product.image_1) }}" alt="" style="height:150px;width:auto;margin-left:auto;margin-right:auto;">
									{% else %}
										<img src="http://placehold.it/320x150" alt="">
									{% endif %}		

									<div class="caption">
										
										<h4><a href="{{ url('article', {'category_name': product.category_name|lower , 'slugproduct':product.name|slug , 'ID_product':product.ID_product}) }}">{{ product.name }}</a>
										</h4>
										<p>{{ product.description|slice(0, 70) }}</p>
									</div>
									<div class="ratings">
										<a href="{{ url('article', {'category_name': product.category_name|lower , 'slugproduct':product.name|slug , 'ID_product':product.ID_product}) }}" class="btn btn-primary pull-right"> Details </a>
										<h4>€ {{ (product.price)|number_format(2, '.', ' ') }}</h4>
									</div>
								</div>
							</div>

						{% endfor %}

					{% endif %}


				</div>


				{% if page is defined %}

					<div class="paging col-xs-12" style="text-align:center;margin:25px 0;">
						{% if (pageMax) > 1 %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': 1 }) }}" class="btn btn-default">Début</a>
						{% endif %}

						{% if (page - 1) > 1 %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': (page - 1) }) }}" class="btn btn-default">Précédent</a>
						{% endif %}
						&nbsp;&nbsp;
						{% if (page - 2) >= 1 %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': (page - 2) }) }}" class="btn btn-default">{{ (page - 2) }}</a>
						{% endif %}
						&nbsp;&nbsp;                       
						{% if (page - 1) >= 1 %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': (page - 1) }) }}" class="btn btn-default">{{ (page - 1) }}</a>
						{% endif %}
						&nbsp;&nbsp;
						<a href="#" class="btn btn-primary">{{ page }}</a>
						&nbsp;&nbsp;
						{% if (page + 1) <= pageMax %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': (page + 1) }) }}" class="btn btn-default">{{ (page + 1) }}</a>
						{% endif %}
						&nbsp;&nbsp;   
						{% if (page + 2) < pageMax %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': (page + 2) }) }}" class="btn btn-default">{{ (page + 2) }}</a>
						{% endif %}
						&nbsp;&nbsp; 
						{% if (page + 1) < pageMax %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': (page + 1) }) }}" class="btn btn-default">Suivant</a>
						{% endif %}
						&nbsp;&nbsp;
						
						{% if (pageMax) > 1 %}
							<a href="{{ url('categorie_page', {'category_name': global.request.get('category_name')|lower , 'page': pageMax }) }}"  class="btn btn-default">Fin</a>
						{% endif %}							
					</div> 
				{% endif %}

			</div>
		</div>
	</div>
{% endblock %}

{# include footer #}
{% block footer %}
	{% include 'commerce/footer.html.twig' %}
{% endblock %}